function [y1] = exportedNNKnuckle(x1)
%EXPORTEDNNKNUCKLE neural network simulation function.
%
% Auto-generated by MATLAB, 28-Mar-2022 12:30:52.
% 
% [y1] = exportedNNKnuckle(x1) takes these arguments:
%   x = 20xQ matrix, input #1
% and returns:
%   y = 5xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.transform = [0.0596156993798949 -0.307908183271873 0.0385080620453346 -0.311615540298033 0.0153861024587576 -0.300241938327233 -0.0242472343770604 -0.301659129426952 -0.0816849501668081 -0.338184582154698 0.0629410374879199 -0.307908183271873 0.012365178888771 -0.311615540298033 0.017349469626595 -0.300241938327233 0.00726888345744863 -0.30165912942695 -0.090276119515479 -0.338184582154697;0.0216133363848296 0.394168436841781 0.0265628710914656 0.371338062953966 0.0457243610447555 -0.274370469350471 0.0355619472987167 -0.295543231119553 0.0376710470725672 -0.196871280157873 0.0179465820714799 0.394168436841781 0.0351563485122066 0.371338062953965 0.0296057982284511 -0.274370469350471 0.0298496953185276 -0.295543231119567 0.0379381512153766 -0.196871280157883;-0.00714324298926271 0.0473220176664263 -0.0128822127155383 -0.0383452397389158 -0.0140595264643304 -0.522082975006559 -0.0036863033382432 0.469157131317158 -0.025723713097029 0.0374306245370015 -0.0110216799159704 0.0473220176664265 -0.0129927429698663 -0.0383452397389159 0.0300587391961544 -0.522082975006559 -0.0461226995323358 0.469157131317142 0.00304564870556249 0.0374306245369932;-0.0573833949132163 0.0656794487086687 -0.0434194386741753 -0.17249546786791 -0.0393136297654426 -0.219669746330598 -0.0370238165070508 -0.313726772718293 0.0158700928374894 0.552621912894816 -0.0747651235382919 0.0656794487086688 -0.0599573390634819 -0.17249546786791 -0.0686598636116549 -0.219669746330598 -0.07279985277743 -0.313726772718291 0.0133240972352617 0.552621912894818;-0.000514030765900196 -0.484115148864874 -0.0401297431854671 0.480743656629823 -0.0213519691415551 -0.10632332171986 -0.0160011523648082 -0.04326456605055 -0.0116061145937134 0.128527159893397 -0.0294498064820014 -0.484115148864875 -0.0420909159964766 0.480743656629824 -0.0438215813085557 -0.10632332171986 -0.0432175700768494 -0.0432645660505429 -0.0275750333966496 0.128527159893407;0.156616739108233 -0.0736273292624188 0.141634438233953 -0.0157818862365251 0.138316948018057 -0.0289401910565987 0.134957918756 -0.00748123441700517 0.213289317280001 0.0989596194671151 0.375124721561078 -0.073627329262419 0.36093939949295 -0.0157818862365252 0.402533274321434 -0.0289401910565985 0.406507545112071 -0.00748123441701696 0.491510916874878 0.0989596194671047;0.0675409542852452 -0.00137131668815605 0.0222078445736982 0.00427602568115656 0.0447905106779393 0.032112982438075 -0.0329507872563257 -0.022079052029238 -0.0633330035596764 -0.00339866666518628 -0.0662371898080365 -0.00137131668815606 -0.0293186931847027 0.00427602568115645 0.688033548525128 0.0321129824380749 -0.705390532995624 -0.0220790520292483 0.0923483107964219 -0.00339866666520145;-0.317986388677439 -0.0521022103369591 -0.186234758019966 -0.0425473473446605 -0.0657489425945149 -0.0198817524096118 0.120974803475108 -0.0140344875390325 0.431608055114575 -0.110353685320409 -0.484477998116753 -0.0521022103369585 -0.0701470643653691 -0.0425473473446605 -0.142821341824667 -0.0198817524096117 -0.0979943292090848 -0.0140344875390187 0.595589924759254 -0.11035368532039;0.361483940405979 -0.00722832919422005 0.332739815732165 -0.011923527611055 0.213845208605159 0.000559101000958136 0.216602037287619 0.0170538841753996 0.365456256623766 0.00852292409734309 0.25703462209034 -0.0072283291942205 0.0793161118029888 -0.011923527611055 -0.4802023311217 0.000559101000958109 -0.476356983787585 0.0170538841753906 0.0377435171933033 0.0085229240973387;-0.251406282009839 0.0166424601580264 -0.250221835425217 0.0121212513391978 -0.351903061104527 0.00732593767086409 -0.291108810790762 -0.00650252636457809 -0.288284612619791 -0.0293672539245443 0.476042284769073 0.0166424601580269 0.315226662675919 0.0121212513391979 -0.260159759280207 0.00732593767086409 -0.282228387305436 -0.00650252636453938 0.326207228118021 -0.029367253924502;-0.0685821003816992 -0.00959843497895857 0.286964762637234 0.0065045590245361 -0.0157672006826989 -0.00293004505610487 -0.109665651593639 0.00338267862879183 -0.0643690098595481 0.0171772101645553 -0.463319182671155 -0.00959843497895821 0.804372067171368 0.00650455902453617 -0.0434123519308269 -0.00293004505610456 -0.0431814648324921 0.00338267862878089 -0.17378660967683 0.0171772101645783;0.457836012310926 0.00992639249223167 0.2665103735934 0.00717021636742008 0.0760039829115418 0.0100506216382924 -0.259255375536826 0.00426088498153563 -0.51379902515064 0.00220586838095175 -0.283314839467319 0.00992639249223102 -0.194042814883782 0.00717021636742048 -0.154045609442261 0.0100506216382929 0.0639963526418916 0.00426088498152429 0.485886360638853 0.00220586838093255;-0.176546100906276 -0.00368356898582678 -0.141143641937013 -0.000526863898719808 0.718820833923949 -0.000218213406396173 -0.633216214353448 0.0115796864968499 0.161470255485727 -0.00435054543493605 0.0569835550214084 -0.00368356898582721 0.00388715080058544 -0.00052686389872002 -0.0374354650212577 -0.000218213406396284 -0.0049436610059614 0.0115796864968249 -0.0122158888259349 -0.00435054543495423;0.288900332456937 0.00945889496997237 0.144370058129837 0.00509856438700573 -0.524943087321933 -0.00357479242908296 -0.588954142761185 0.00359282727619623 0.492234532478785 -0.0180286057870924 -0.0110847569910169 0.00945889496997101 -0.0932902993810048 0.00509856438700508 0.0955296683502787 -0.00357479242908246 0.0687040455288596 0.00359282727628294 -0.0858040698035179 -0.0180286057869862;-0.582755314650386 -0.0119468032318644 0.755940151514183 0.0133256232917327 -0.046404062214339 -0.00225250512582738 -0.0619862080039017 0.0010537772780162 -0.0436428126848851 -0.000420889613100949 0.135380525002208 -0.0119468032318632 -0.240778377561492 0.0133256232917319 0.0323098686499558 -0.00225250512582783 0.00777853043810249 0.00105377727798385 0.0546858507263307 -0.000420889613012844];
x1_step2.xoffset = [-1.76651638063803;0.000382189394435495;0.00143950621446491;0.0233927951097328;0.00620784547531587;0.00688012582644341;-0.00384791517233976;0.104062606244368;0.00282605043022257;0.0075985627488781;-0.00425854725132311;-0.0137069059151199;-0.000826721121668277;0.00133195348024186;-0.000316183704815298];
x1_step2.gain = [0.908107303446967;1.59048798372386;1.79409906992424;1.92730774138439;1.94682119342759;2.82315107687296;3.65581375689458;4.78837013669057;5.82773080409737;6.83254488830193;9.03519578173264;12.1227607046142;15.5631350056034;17.5321119166046;21.2895326987864];
x1_step2.ymean = 0;

% Layer 1
b1 = [-2.007137244075419158;-2.0846780247973848432;1.4082554559314661713;0.8572444613491104759;1.2343553196614509559;-1.087090751646410558;-0.7354990861799730606;-0.95090742782742831984;0.51226797413368452272;-0.091657791731772769728;-0.1366314403929569099;0.57977907320999166885;0.57150177226382969931;-0.130557939721026528;-0.44805868482287347643;0.38070846162337418361;0.11369260189416713347;0.34043031124832107137;0.15550584080470006287;-0.1007349307834267127;0.66485543563851190463;0.72702275243128533511;1.3597716429124875326;0.10367364293854905433;1.0335757955312716572;-1.3558853694152006586;-1.2081535100043514497;-1.8267242124833664718;2.0009563939931171994;-1.7036626443379339069];
IW1_1 = [0.29320663546084196893 0.23571020041477891427 -0.26011319967460810876 -0.095478732032934179874 -0.3084621615476684231 0.26490513134023774278 0.082064342380597204984 0.059559500803145780379 -0.15180942861495200225 0.075927700143839496616 0.17637190548570289006 -0.21555877300147510689 0.17672333171824033959 0.040037079148239444748 -0.10972036559002892875;0.38486956728474014389 -0.20273844553964412429 0.025601050150667815225 -0.16369676308823252753 -0.12145987963653176456 0.028006753448425493469 -0.20493832450366739062 0.072611595531180794794 0.0034048459636032779932 -0.022995089095590427741 0.086502366262524846285 0.17791175979927975614 0.03755378697089560569 0.12736660001322575031 -0.1336833184748741632;-0.89049006970420274687 0.46894849868473620358 -0.3812444717446350495 -0.46124736189445214585 -0.21094700103344410369 0.48797630621331222756 0.0078006680591521451729 0.45713991387951047329 0.23910852568922200123 -0.28762833162789069874 -0.20701324020686254213 0.4052498053346416107 0.066620001704082082439 0.41779918270413307635 0.31052737793913598452;-0.00020318343357153252713 -0.19410880363739968502 0.18234490867031610817 -0.36846425201702115437 -0.39090427779283737353 -0.0072788144909342088543 0.36989108831781009057 0.17699992808421863288 0.027229754960936995017 -0.021559797859675124826 0.051233038354428057926 -0.022658542752904721473 0.043364463368347684613 0.12828761447514205885 -0.08408211286829593567;0.19278237830673014552 -0.23054285193539161836 -0.36213507489649915394 0.28890836757306903593 0.77875146131971217933 -1.8599847354367768926 0.3532385335912648916 0.076044405301028697441 0.81412088655103143076 -0.23522163265017348444 -0.18553554594877855188 0.066534911594999843198 0.17738725136696043005 0.055148772133101764403 -0.13301592215807489517;-0.11126393830784209182 -0.1170830438737434781 -0.22141662762821523458 0.15306557933587031095 0.45468236055105532012 0.55182894067529164595 -0.30408370420773450649 -0.20469204603243695839 -0.45354318745074495567 0.65467182324461192788 0.79950998653665683591 -0.20100556982060427402 0.089665563032256742626 -0.024322670033250216176 -0.32872268992313696812;-0.17719813690451705068 0.08031654325729063737 0.19520620789751680357 0.050963907473916353341 0.10412216370302350421 1.1037083358235215691 -0.45032938043963632868 -0.1743603043104513528 -0.27083634455689903353 0.23590853307083259338 0.39118258096725050388 0.19371778197669739519 0.076982269161498542709 -0.11476887230360988124 0.087475820659580066918;-0.10987415241326617399 -0.73599754585894516801 0.13044256614166840902 0.70752335390983600583 0.019946115887940873979 -2.6764082218373572708 0.34762221323469216783 0.15200622347184825078 0.38188088601696901225 -1.0134581044834061192 -0.56708216322248727881 0.07486328380837187213 -0.16525055110729081065 0.11914452321236747301 0.29112539469689874272;0.40008092632468739147 -0.077341881032705686594 0.19775296169041756134 0.32325938257009345644 -0.46753862461809353457 0.075946575827494908206 0.27107344961798324201 -0.2653222727238215839 0.37500233735073629227 -0.27684143256527982135 -0.40457572050103596251 0.03215015237876541615 -0.1634552469545010045 -0.15164898823028369335 0.16189749107937670414;0.16092617122965252596 0.10242827073868103482 -0.034242186548804086355 0.091418833432456214627 0.40648728827146624054 -1.2129754565628663165 0.034632565070808377095 0.54956545271766321648 0.098048094118028145116 -2.0958000124504634343 0.32267876794484806613 0.4945636843259593185 -0.013203426305211683062 0.48416038106961728493 0.020756549061908914633;-0.17642302694718473011 -0.2186085216853750901 0.20044842208896704316 0.33096251175094715258 0.14407860357655608019 -2.5069989521544755462 0.38766576750393383355 0.025554460717323267821 -0.06215833900547849955 -0.21019156206932049225 -0.6933923566615840528 0.27951297880624587089 -0.31610306197554788321 -0.056664942172827970079 0.031742524458826242018;-0.60814450362134619965 0.42733770320701019996 -0.063047640917340608269 0.19738541387530605942 -0.055487262822918062555 -1.549226651749785022 0.23495028814070892387 -0.20227207399911018015 -0.38166082182313793014 0.13772955715529913712 -0.27621324092962135088 -0.1977714680137074299 -0.38854415450384971464 -0.067344644500339029269 -0.22641076854977218447;-0.72997943560598843593 0.19858044579535641394 0.26805656099870889264 -0.49632222738435860521 -0.23490844606075342305 0.88213298272057583116 -0.68488459202500662215 0.90092788583071448105 1.48833499435254768 -1.923519561073207651 0.32274236456623894842 0.18298505550537494391 -0.002209219156959452493 0.2777879485557120387 0.30393739534537794755;-0.064955800901357607646 -0.22428224068113472578 -0.14400939209766874805 0.37735476305561838073 -0.061385498289130438487 -1.5094039269355892241 0.021942340504425582315 0.017044138558857564736 -0.8733151773332230583 0.96183375926912773046 -0.20738213138550687376 -0.072117559718925472456 -0.16369397888820377829 -0.1776923666441524996 -0.18614117220391943053;0.9712457609839983963 -0.2291920827255781723 -0.098488205704847439637 -0.17177205161626676877 -0.45980977205486184278 2.5924745405650617691 -0.073892704047926208166 0.095001192794992195267 -0.12213616608253030638 0.9597802643673587486 1.0060472668496380777 -0.25571402863872833011 0.15406674600204120495 0.05561023233434799623 -0.22352430142296575433;-1.2912738543560402515 -0.20540273458765273551 -0.23647983695499946721 0.4844907420027844136 -0.045647928714589121324 -1.1614849412969436848 -0.48375095526779887667 0.80616069947702539977 -1.0704761694383855275 0.56594286572818086611 -0.034538965808994084861 -0.056373209775252661191 0.44638472767912718009 0.36586150416530283103 0.24589037819829148712;-0.34091892795268458061 0.21694445393475667028 -0.36768745951041464926 -0.044141630978867439639 -0.24928479439246686855 0.2757217865092218001 0.47550612357435539934 -1.0181783800031571907 -1.2057193310490117444 1.5854049247219701435 -0.39729787445094244536 -0.266799051496701356 -0.061704075522402535015 0.1507165573448581708 0.30225816083863277228;-0.90958360434403562333 0.28985190030060714594 -0.37827543340278124706 -0.22437724607994177783 0.00011690408581704891944 2.863233383191378767 -0.37779552803363042335 -0.4780101780622318941 0.18860300870785651206 0.094851442077593439706 0.47957315432684033407 -0.054917916378443190628 0.20166496033873915206 0.11735713925790150491 0.11140667232740344983;-0.70580181882666537252 -0.7037757598057544639 0.087362682656099074907 0.33041965799710198981 0.01883248372093816736 -0.66916418776609642993 -0.86844656617891058392 0.51226440484481750026 -1.2749058302656399722 0.6518434778979056432 0.55045190122497400509 -0.34352917035843982818 0.11734979471446226051 0.52408487011419668811 0.011587352970866148308;-0.84509806377178453562 -0.49214663249399803746 -0.14911711018048351418 0.35919034172284569628 0.50355617466922697467 -2.629673894600821793 0.41806853965453794064 -0.32724007232708524073 0.64881043405628002763 -0.9027532057288615297 -1.2104442143407752042 0.13553160698152597052 -0.055224920494250810676 -0.13441301057302587618 0.10387488762285072841;0.90418117843945633449 0.31551115141406627096 -0.14835014287945966216 0.38253586938480421686 0.21266274999726655914 0.51035447572769632174 1.024985622219431125 -0.80707453556236574688 0.10719613332277494466 0.45140508151153985184 0.16573992384092248176 -0.27399626827610368274 -0.2097182358566792304 -0.55889279737809183235 -0.55839482946975427247;-0.16134746200125385518 0.10637422868091733763 -0.0060025674443925326404 0.16522240082335407085 0.073051053134955162838 -1.6926448255801551657 -0.21744175845740229547 0.82386090261702582538 -1.0856609995813424341 0.80662033075724359765 0.20060976737838159822 -0.44503127091916561131 -0.027164171318279934503 0.15570919375819508579 0.036484196116757780515;0.12205650072074296364 0.081580914204338925155 0.36440061045771982018 0.060209295836156008497 0.041184566059982274933 -0.24661874693964602745 0.061960019062174000182 0.47678499065460816508 -0.2331451146647082473 0.045218801120811814853 -0.13209774217562042509 0.16244320277240559269 -0.38736533921862176255 0.0096205452212867852146 -0.01482625426715937153;0.94652717020757282107 -0.90194033567909726035 -0.097428924424020860173 0.18586366937034343172 -0.39220439669204970601 0.73948022624543019443 -0.46693539976105696843 0.99796719143280154807 -0.86341184594095998772 1.2535939864047005443 0.39825802510369362475 -0.6327130147595868559 0.79159118604460187996 0.55107357391743827524 -0.52820697415567208211;0.23764034701414846196 0.27490589129234221932 -0.80245187729863365345 -0.23268862692349207011 -0.071331328171082467038 0.88075738836194217285 -0.43375279426338020361 0.53883945851366543689 0.42247945502487893599 -0.44133018185126354771 0.026294879313419283751 -0.14705108240370928785 -0.55045924146696345591 -0.096479970254741351243 -0.10947373352354707043;-0.29211431217396932603 -0.65119815659245383621 -0.057434055857268857814 0.08197795291093486203 -0.057173050656208479481 -1.4408444045713222348 -0.30213584635061174755 -0.068516935897246819542 0.60965209192228420054 -0.8050779528831775167 -0.42328036959585496612 -0.46690876376155998617 0.23129127935387439052 0.40239342644155329243 -0.059434879734614372293;-0.79269362708327406608 0.090809522079814283813 -0.80185748720217031593 0.11805098189126606023 0.13557913139707156169 0.57717512539957516182 -0.51654605352215099412 0.31514837266758138901 -0.61955228619193991602 0.41029669125376649896 0.3367950906580418069 -0.14944329493082572635 0.10481331352057493556 0.20292803032827474996 -0.080603011941019819808;-0.1510039948880751437 -0.1260874854749308438 0.12246818022464202314 -0.63084397461385344208 -0.19770967239540057636 0.27661799358010868977 0.097512900604582189446 -0.56617536419001801562 -0.081510148556975109413 -0.38107258394790838318 -0.048948910168262582676 -0.20601508427569165116 0.052604406797680719476 -0.41467247355689418331 0.10552251699654734141;-0.67844053695906214596 -0.87065799973905588782 0.037973610284644222779 0.46705411817219943948 0.20183435721988582379 -1.949284355739264285 -0.80642442667235803011 0.52382507243053721968 -1.2407801739077308767 0.067599309001410173847 0.090482711778085950227 -0.2103412673310213199 -0.14748425872715437146 -0.041579296352463157582 0.30821893580879428098;-0.39750279145400718717 0.067746445658784223975 0.36420547284320936576 -0.10035664671225667799 0.31680931908557602439 0.1480989616374550899 -0.048329861250193173472 0.2073868486396691635 -0.089430027419200072702 0.16663217237577923613 0.033136340581839889008 -0.19677285583281628467 0.19550832731868039716 -0.058812911494230256382 0.05725016369063590238];

% Layer 2
b2 = [-1.0182944128097382031;0.42582191419541720601;-0.62425791338524849738;-0.627123985406123019;-0.059708671848260751192];
LW2_1 = [0.55910132395082712264 0.69654014391457819144 0.77654067185460107225 0.44135644161756570902 0.32549009075426732496 -0.89457543012441131935 -0.37549881935018819545 1.9442904637352496078 -0.045255668861616540899 1.1809628159683689397 0.94808073065350906283 0.28194576189341719052 1.3377270409516750505 -0.30502981189536698681 -0.093277692613406515409 0.44511449853452361713 -1.3288903769240820729 -1.9994005774349157267 -0.14818750597874219554 1.9148860654127750625 -1.122996547555298541 -0.0013799507299261542549 0.71207148693980915066 0.61207907977243536379 0.42463980427447145516 2.0108471556173959094 -0.25565276930148050916 0.41316318787325478912 0.95843635993831188813 -0.023998240900827954442;-0.49088095274126541945 -0.6921811164268690808 -0.26721604849612917709 0.042220238756708945715 0.8324240052286951963 -0.94409031596140280396 0.12493219990591165891 -0.93688469008257713178 0.089100555149316959525 0.66982858688799784552 -0.68909500481349406087 0.51175468362760623275 0.61745356041946930503 -0.62374050637333733338 -0.81673296291141816994 -0.052102506823413274883 0.14619335774983738263 0.76478346166942845485 -0.70413428283477141889 1.5694787852531162375 -0.57935961136219182865 -0.86153006643649787666 0.59170929774919189814 -1.272306700226168541 0.30881522507340819494 -0.22764820869783042312 0.10673752696792572492 0.5030685187451220397 0.46032650301197353127 0.47567251858661829811;0.73926384372463549433 0.58786818499976689623 -0.7431304118271471193 0.085521671679124597332 -0.56247299600663880348 -0.65250141748770229544 1.0520736525313254539 -0.93333257395482660534 0.52886338962280921017 0.11327362094912825363 -1.5375287686634264706 -1.4362868976973448554 -0.023850104011312076718 -1.2382495660727912412 2.3990802738576206821 -1.3822577140525633688 -0.11976477043842131964 1.9015512917102426194 -1.3470039578868699959 -1.5153296961906452811 0.2388889647291662921 -2.0828756989005037248 0.070822013949761147833 0.45850579458941742583 0.57067504861989282183 0.41352052865951877125 -0.80824310274867017245 1.4929138374091519559 -1.7897428443249310259 -0.26611787627996585925;-0.42878604249216784039 -0.041023498541786072857 -0.72027702182957764609 0.28784069941907575174 1.3668697851576063762 -0.40968802214333682743 -0.010371520350958708667 0.35682899070188744961 0.19708960915373571754 -0.73703021690350178918 1.1899673470411142873 1.0375143477876993536 -2.0993401920714958031 1.0740990534898129383 -1.212651377518624507 0.99864012074039698597 0.90605735556861355384 -1.3632107822404389008 0.29189244101460537495 0.18264865395270796222 0.38956288113712000953 1.6501268091985721309 0.79567251997029098121 0.67653579223675641696 -1.1294405800900977344 0.50192065050495060508 0.039063533049795581831 0.35281016372448942287 -0.18221100189959879567 -0.15063928371166288023;0.70250356608798691926 0.1004103855920558952 0.97775910172587043867 0.055780252090343977744 -0.96269265137985959857 0.16493521906215555251 1.1329667935323546324 -1.2434426501641204776 -0.17940162823844654771 -1.3661318556463424301 -1.1306040996384048025 -0.15397957940362860807 -0.47158187638232607064 0.37947345626215250869 1.2303296591993773124 1.167010980841640011 1.4760637043090343301 2.5318979212175980464 1.1040368700389615597 -2.0355120138859841283 -0.70301964087093526956 0.51337969790232684808 0.63668097851561955558 1.4399645489123378272 -0.10571292393158347733 -0.40800168500782701964 0.48517061208641948378 0.14460982772287614417 0.57110429569049026011 0.40654687513082854444];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = processpca_apply(x1,x1_step1);
xp1 = mapstd_apply(xp1,x1_step2);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);

% Output 1
y1 = a2;
end

% ===== MODULE FUNCTIONS ========

% Map Standard Deviation and Mean Input Processing Function
function y = mapstd_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymean);
end

% Map Minimum and Maximum Input Processing Function
function y = processpca_apply(x,settings)
  y = settings.transform * x;
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
  if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
  else
    a = iSoftmaxApplyCPU(n);
  end
end
function a = iSoftmaxApplyCPU(n)
  nmax = max(n,[],1);
  n = bsxfun(@minus,n,nmax);
  numerator = exp(n);
  denominator = sum(numerator,1); 
  denominator(denominator == 0) = 1;
  a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
  nmax = max(n,[],1);
  numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
  denominator = sum(numerator,1);
  a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
  numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
  if (denominator == 0)
    a = numerator;
  else
    a = numerator ./ denominator;
  end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end
